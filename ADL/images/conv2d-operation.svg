<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 820 380" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <style>
      .title { font-size: 16px; font-weight: 700; fill: #1e293b; }
      .label { font-size: 13px; font-weight: 600; fill: #475569; }
      .cell-text { font-size: 11px; fill: #334155; font-weight: 500; }
      .formula { font-size: 12px; fill: #6366f1; font-weight: 600; font-style: italic; }
      .dim-label { font-size: 11px; fill: #94a3b8; font-weight: 500; }
    </style>
    <!-- Input cell -->
    <linearGradient id="inputGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#eff6ff"/>
      <stop offset="100%" stop-color="#dbeafe"/>
    </linearGradient>
    <!-- Highlighted input region -->
    <linearGradient id="highlightGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#c7d2fe"/>
      <stop offset="100%" stop-color="#a5b4fc"/>
    </linearGradient>
    <!-- Kernel cell -->
    <linearGradient id="kernelGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fef3c7"/>
      <stop offset="100%" stop-color="#fde68a"/>
    </linearGradient>
    <!-- Output cell -->
    <linearGradient id="outputGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d1fae5"/>
      <stop offset="100%" stop-color="#a7f3d0"/>
    </linearGradient>
    <!-- Active output cell -->
    <linearGradient id="activeOutputGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#6ee7b7"/>
      <stop offset="100%" stop-color="#34d399"/>
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="410" y="28" text-anchor="middle" class="title">Conv2D Operation — Sliding Window</text>

  <!-- ====== INPUT 5×5 ====== -->
  <text x="135" y="58" text-anchor="middle" class="label">Input (5×5)</text>

  <!-- Input grid — 5 rows × 5 cols, cell size 40 -->
  <g transform="translate(35, 65)">
    <!-- Row 0 -->
    <!-- Highlighted region: rows 0-2, cols 0-2 -->
    <rect x="0" y="0" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="20" y="25" text-anchor="middle" class="cell-text">1</text>
    <rect x="40" y="0" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="60" y="25" text-anchor="middle" class="cell-text">0</text>
    <rect x="80" y="0" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="100" y="25" text-anchor="middle" class="cell-text">1</text>
    <rect x="120" y="0" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="140" y="25" text-anchor="middle" class="cell-text">2</text>
    <rect x="160" y="0" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="180" y="25" text-anchor="middle" class="cell-text">0</text>

    <!-- Row 1 -->
    <rect x="0" y="40" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="20" y="65" text-anchor="middle" class="cell-text">0</text>
    <rect x="40" y="40" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="60" y="65" text-anchor="middle" class="cell-text">1</text>
    <rect x="80" y="40" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="100" y="65" text-anchor="middle" class="cell-text">2</text>
    <rect x="120" y="40" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="140" y="65" text-anchor="middle" class="cell-text">1</text>
    <rect x="160" y="40" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="180" y="65" text-anchor="middle" class="cell-text">0</text>

    <!-- Row 2 -->
    <rect x="0" y="80" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="20" y="105" text-anchor="middle" class="cell-text">1</text>
    <rect x="40" y="80" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="60" y="105" text-anchor="middle" class="cell-text">0</text>
    <rect x="80" y="80" width="40" height="40" rx="3" fill="url(#highlightGrad)" stroke="#6366f1" stroke-width="1.5"/>
    <text x="100" y="105" text-anchor="middle" class="cell-text">3</text>
    <rect x="120" y="80" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="140" y="105" text-anchor="middle" class="cell-text">1</text>
    <rect x="160" y="80" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="180" y="105" text-anchor="middle" class="cell-text">2</text>

    <!-- Row 3 -->
    <rect x="0" y="120" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="20" y="145" text-anchor="middle" class="cell-text">2</text>
    <rect x="40" y="120" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="60" y="145" text-anchor="middle" class="cell-text">1</text>
    <rect x="80" y="120" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="100" y="145" text-anchor="middle" class="cell-text">0</text>
    <rect x="120" y="120" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="140" y="145" text-anchor="middle" class="cell-text">1</text>
    <rect x="160" y="120" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="180" y="145" text-anchor="middle" class="cell-text">0</text>

    <!-- Row 4 -->
    <rect x="0" y="160" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="20" y="185" text-anchor="middle" class="cell-text">0</text>
    <rect x="40" y="160" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="60" y="185" text-anchor="middle" class="cell-text">1</text>
    <rect x="80" y="160" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="100" y="185" text-anchor="middle" class="cell-text">2</text>
    <rect x="120" y="160" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="140" y="185" text-anchor="middle" class="cell-text">1</text>
    <rect x="160" y="160" width="40" height="40" rx="3" fill="url(#inputGrad)" stroke="#93c5fd" stroke-width="1"/>
    <text x="180" y="185" text-anchor="middle" class="cell-text">3</text>

    <!-- Highlight border around 3×3 region -->
    <rect x="-2" y="-2" width="124" height="124" rx="5" fill="none" stroke="#6366f1" stroke-width="2.5" stroke-dasharray="6,3"/>
  </g>

  <!-- ====== KERNEL 3×3 ====== -->
  <text x="395" y="58" text-anchor="middle" class="label">Kernel (3×3)</text>

  <g transform="translate(315, 90)">
    <rect x="0" y="0" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="26" y="31" text-anchor="middle" class="cell-text">1</text>
    <rect x="52" y="0" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="78" y="31" text-anchor="middle" class="cell-text">0</text>
    <rect x="104" y="0" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="130" y="31" text-anchor="middle" class="cell-text">-1</text>

    <rect x="0" y="52" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="26" y="83" text-anchor="middle" class="cell-text">0</text>
    <rect x="52" y="52" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="78" y="83" text-anchor="middle" class="cell-text">1</text>
    <rect x="104" y="52" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="130" y="83" text-anchor="middle" class="cell-text">0</text>

    <rect x="0" y="104" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="26" y="135" text-anchor="middle" class="cell-text">-1</text>
    <rect x="52" y="104" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="78" y="135" text-anchor="middle" class="cell-text">0</text>
    <rect x="104" y="104" width="52" height="52" rx="3" fill="url(#kernelGrad)" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="130" y="135" text-anchor="middle" class="cell-text">1</text>
  </g>

  <!-- ====== Multiply arrow ====== -->
  <text x="290" y="175" text-anchor="middle" font-size="22" fill="#6366f1" font-weight="700">⊗</text>

  <!-- ====== Equals arrow ====== -->
  <line x1="480" y1="165" x2="540" y2="165" stroke="#64748b" stroke-width="2" marker-end="url(#arrowGray)"/>
  <defs>
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#64748b"/>
    </marker>
  </defs>

  <!-- ====== OUTPUT 3×3 ====== -->
  <text x="650" y="58" text-anchor="middle" class="label">Output (3×3)</text>

  <g transform="translate(570, 90)">
    <!-- Active cell (0,0) highlighted -->
    <rect x="0" y="0" width="52" height="52" rx="3" fill="url(#activeOutputGrad)" stroke="#059669" stroke-width="2"/>
    <text x="26" y="31" text-anchor="middle" class="cell-text" font-weight="700">4</text>
    <rect x="52" y="0" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="78" y="31" text-anchor="middle" class="cell-text">?</text>
    <rect x="104" y="0" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="130" y="31" text-anchor="middle" class="cell-text">?</text>

    <rect x="0" y="52" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="26" y="83" text-anchor="middle" class="cell-text">?</text>
    <rect x="52" y="52" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="78" y="83" text-anchor="middle" class="cell-text">?</text>
    <rect x="104" y="52" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="130" y="83" text-anchor="middle" class="cell-text">?</text>

    <rect x="0" y="104" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="26" y="135" text-anchor="middle" class="cell-text">?</text>
    <rect x="52" y="104" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="78" y="135" text-anchor="middle" class="cell-text">?</text>
    <rect x="104" y="104" width="52" height="52" rx="3" fill="url(#outputGrad)" stroke="#6ee7b7" stroke-width="1"/>
    <text x="130" y="135" text-anchor="middle" class="cell-text">?</text>
  </g>

  <!-- ====== Calculation annotation ====== -->
  <rect x="60" y="295" width="700" height="55" rx="8" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="410" y="318" text-anchor="middle" class="formula" font-size="12">
    (1×1) + (0×0) + (1×−1) + (0×0) + (1×1) + (2×0) + (1×−1) + (0×0) + (3×1) = 4
  </text>
  <text x="410" y="340" text-anchor="middle" class="dim-label">
    stride = 1, padding = 0  →  output size = ⌊(5 + 0 − 3)/1⌋ + 1 = 3
  </text>
</svg>
